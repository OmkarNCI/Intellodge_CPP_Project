{% extends 'intelrev/base.html' %}
{% load static %}

{% block content %}
<div class="row justify-content-center mt-5">
  <div class="col-md-6">
    <div class="card shadow-sm border-0 rounded-3">
      <div class="card-body p-4">
        <h3 class="mb-4 text-center">
          {% if room.room_number %}Edit Room{% else %}Add Room{% endif %}
        </h3>

        <!-- FORM START -->
        <form method="post" class="needs-validation" novalidate enctype="multipart/form-data">
          {% csrf_token %}

          <!-- Room Number -->
          <div class="mb-3">
            <label for="room_number" class="form-label fw-semibold">Room Number</label>
            <input
              type="text"
              class="form-control"
              id="room_number"
              name="room_number"
              placeholder="e.g. A101"
              value="{{ room.room_number|default:'' }}"
              required
            />
            <div class="invalid-feedback">Room number is required.</div>
          </div>

          <!-- Room Type -->
          <div class="mb-3">
            <label for="room_type" class="form-label fw-semibold">Room Type</label>
            <select class="form-select" id="room_type" name="room_type" required>
              <option value="" disabled selected>Select room type</option>
              {% for type in room_types %}
                <option value="{{ type }}" {% if room.room_type == type %}selected{% endif %}>
                  {{ type }}
                </option>
              {% endfor %}
            </select>
            <div class="invalid-feedback">Please select a room type.</div>
          </div>

          <!-- Price -->
          <div class="mb-3">
            <label for="price" class="form-label fw-semibold">Price ($)</label>
            <input
              type="number"
              step="0.01"
              class="form-control"
              id="price"
              name="price"
              placeholder="Enter price"
              value="{{ room.price|default:'' }}"
              required
            />
            <div class="invalid-feedback">Price is required.</div>
          </div>

          <!-- Status -->
          <div class="mb-3">
            <label for="status" class="form-label fw-semibold">Status</label>
            <select class="form-select" id="status" name="status" required>
              <option value="" disabled selected>Select status</option>
              {% for s in status_options %}
                <option value="{{ s }}" {% if room.status == s %}selected{% endif %}>
                  {{ s }}
                </option>
              {% endfor %}
            </select>
            <div class="invalid-feedback">Please select a room status.</div>
          </div>
          
          <!-- Image Upload -->
          <div class="mb-3">
            <label for="room_image" class="form-label fw-semibold">Room Image (optional)</label>
            <input type="file" accept="image/*" class="form-control" id="room_image" name="room_image">
            <div class="form-text">Upload a representative image for this room type.</div>
          </div>
          
          <!-- Image Preview -->
          <div class="mb-3" id="imagePreviewContainer" style="display: none;">
            <label class="form-label">Preview:</label>
            <div class="border rounded p-2">
              <img id="imagePreview" src="" alt="Preview" class="img-fluid" style="max-height: 200px;">
            </div>
          </div>

          <!-- Buttons -->
          <div class="d-flex justify-content-end mt-4">
            <a href="{% url 'room_list' %}" class="btn btn-outline-secondary me-2">Cancel</a>
            <button type="submit" class="btn btn-primary">
              {% if room.room_number %}Update Room{% else %}Add Room{% endif %}
            </button>
          </div>
        </form>
        <!-- FORM END -->
      </div>
    </div>
  </div>
</div>

<script src="{% static 'intelrev/js/room.js' %}"></script>
{% endblock %}
